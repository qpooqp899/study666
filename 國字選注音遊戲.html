<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
<title> ğŸ“™ åœ‹å­—é¸æ³¨éŸ³éŠæˆ²</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />

  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #fdfaf6;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    .container {
      max-width: 600px;
      margin: auto;
      padding: 20px;
    }
    .char {
      font-size: 60px;
      margin: 20px 0;
      color: #2c3e50;
    }
    .selected, .score, .timer, .coin-display {
      font-size: 20px;
      margin: 10px;
    }
    .options button, .controls button {
      font-size: 24px;
      margin: 5px;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .options button {
      background: #ecf0f1;
    }
    .options button:hover {
      background: #bdc3c7;
    }
    .controls button {
      background: #3498db;
      color: white;
    }
    .controls button:disabled {
      background: #95a5a6;
    }
    .message {
      font-size: 24px;
      margin: 10px;
      height: 30px;
    }
    #startBtn {
      background: #27ae60;
      color: white;
      font-size: 36px;
      padding: 20px 60px;
      margin: 30px 0 30px 0;
    }
    .options {
      margin-bottom: 50px;
    }
    .controls {
      margin-top: 50px;
    }
    .speed-control {
      margin: 10px;
      font-size: 16px;
    }
    .bounce {
      display: inline-block;
      animation: bounce 0.4s ease-in-out;
    }
    @keyframes bounce {
      0% { transform: scale(1); }
      50% { transform: scale(1.5); }
      100% { transform: scale(1); }
    }
    @media (max-width: 480px) {
      .char { font-size: 48px; }
      .options button, .controls button { font-size: 18px; padding: 8px 16px; }
    }
  </style>
</head>
<body>
<div class="container">
    <a href="index.html" style="position:absolute;left:10px;top:10px;font-size:24px;text-decoration:none;background:#eee;padding:6px 18px;border-radius:8px;color:#222;box-shadow:0 2px 6px #ccc;">â† è¿”å›é¸å–®</a>
   <div class="container">
    <h1>ğŸ“™ åœ‹å­—é¸æ³¨éŸ³éŠæˆ²</h1>
  <div class="score" id="scoreBoard">å¾—åˆ†ï¼š0</div>
  <div class="coin-display" id="coinDisplay">é‡‘å¹£ï¼š0</div>
  <div class="timer" id="timer">â³ å€’æ•¸ï¼š180ç§’</div>
  <div style="margin-bottom: 20px;">
    <label for="levelSelect" style="font-size:20px;">é¸æ“‡å¹´ç´šï¼š</label>
    <select id="levelSelect" style="font-size:20px; padding: 4px 12px;">
      <option value="low">ä½å¹´ç´š</option>
      <option value="mid">ä¸­å¹´ç´š</option>
      <option value="high">é«˜å¹´ç´š</option>
    </select>
  </div>
  <button id="startBtn" onclick="startGame()">é–‹å§‹éŠæˆ²</button>
  <div class="char" id="character" style="display:none;">å­—</div>
  <div class="selected" id="selected"></div>
  <div class="options" id="options"></div>
  <div class="controls">
    <button onclick="checkAnswer()">æª¢æŸ¥ / ç™¼éŸ³</button>
    <button onclick="reset()">é‡è¨­</button>
    <button id="nextBtn" onclick="nextQuestion()" disabled>ä¸‹ä¸€é¡Œ</button>
  </div>
  <div class="speed-control">
    ç™¼éŸ³é€Ÿåº¦ï¼š<input type="range" id="speedSlider" min="0.1" max="2" value="0.5" step="0.1"> <span id="speedValue">0.5</span>x
  </div>
  <div class="volume-control">
  ç™¼éŸ³éŸ³é‡ï¼š<input type="range" id="volumeSlider" min="0" max="1" value="1" step="0.01">
  <span id="volumeValue">1.00</span>
</div>
  <div class="message" id="message"></div>
</div>

<audio id="correctSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8d7bcf1751.mp3" preload="auto"></audio>
<audio id="wrongSound" src="https://cdn.pixabay.com/download/audio/2022/03/14/audio_9e06b6f1df.mp3" preload="auto"></audio>

<script>
const questionsLow = [
  { char: "å¥½", zhuyin: ["ã„", "ã„ Ë‡"] }, { char: "ä½ ", zhuyin: ["ã„‹", "ã„§Ë‡"] }, { char: "è¬", zhuyin: ["ã„’", "ã„§ã„Ë‹"] }, { char: "å­¸", zhuyin: ["ã„’", "ã„©ã„ËŠ"] },
  { char: "å¤§", zhuyin: ["ã„‰", "ã„šË‹"] }, { char: "å°", zhuyin: ["ã„’", "ã„§ã„ Ë‡"] }, { char: "å¤©", zhuyin: ["ã„Š", "ã„§ã„¢"] }, { char: "åœ°", zhuyin: ["ã„‰", "ã„§Ë‹"] },
  { char: "äºº", zhuyin: ["ã„–", "ã„£ËŠ"] }, { char: "å£", zhuyin: ["ã„", "ã„¡Ë‡"] }, { char: "æ—¥", zhuyin: ["ã„–", "Ë‹"] }, { char: "æœˆ", zhuyin: ["ã„©", "ã„Ë‹"] },
  { char: "æ°´", zhuyin: ["ã„•", "ã„¨ã„ŸË‡"] }, { char: "ç«", zhuyin: ["ã„", "ã„¨ã„›Ë‡"] }, { char: "å±±", zhuyin: ["ã„•", "ã„¢"] }, { char: "ç”°", zhuyin: ["ã„Š", "ã„§ã„¢ËŠ"] },
  { char: "æœ¨", zhuyin: ["ã„‡", "ã„¨Ë‹"] }, { char: "ç‰›", zhuyin: ["ã„‹", "ã„§ã„¡ËŠ"] }, { char: "ç¾Š", zhuyin: ["ã„§", "ã„¤ËŠ"] }, { char: "é¦¬", zhuyin: ["ã„‡", "ã„šË‡"] },
  { char: "é­š", zhuyin: ["ã„©", "ã„©ËŠ"] }, { char: "é³¥", zhuyin: ["ã„‹", "ã„§ã„ Ë‡"] }, { char: "ç‹—", zhuyin: ["ã„", "ã„¡Ë‡"] }, { char: "è²“", zhuyin: ["ã„‡", "ã„ "] },
  { char: "æ‰‹", zhuyin: ["ã„•", "ã„¡Ë‡"] }, { char: "è¶³", zhuyin: ["ã„—", "ã„¨ËŠ"] }, { char: "è€³", zhuyin: ["ã„¦Ë‡"] }, { char: "ç›®", zhuyin: ["ã„‡", "ã„¨Ë‹"] },
  { char: "é¼»", zhuyin: ["ã„…", "ã„§ËŠ"] }, { char: "å£", zhuyin: ["ã„", "ã„¡Ë‡"] }, { char: "é ­", zhuyin: ["ã„Š", "ã„¡ËŠ"] }, { char: "å¿ƒ", zhuyin: ["ã„’", "ã„§ã„£"] },
  { char: "çˆ¸", zhuyin: ["ã„…", "ã„šË‹"] }, { char: "åª½", zhuyin: ["ã„‡", "ã„š"] }, { char: "å“¥", zhuyin: ["ã„", "ã„œ"] }, { char: "å§", zhuyin: ["ã„", "ã„§ã„Ë‡"] },
  { char: "å¼Ÿ", zhuyin: ["ã„‰", "ã„§Ë‹"] }, { char: "å¦¹", zhuyin: ["ã„‡", "ã„ŸË‹"] }, { char: "å®¶", zhuyin: ["ã„", "ã„§ã„š"] }, { char: "æ ¡", zhuyin: ["ã„’", "ã„§ã„ Ë‹"] },
  { char: "æ›¸", zhuyin: ["ã„•", "ã„¨"] }, { char: "æœ¬", zhuyin: ["ã„…", "ã„£Ë‡"] }, { char: "æ¡Œ", zhuyin: ["ã„“", "ã„¨ã„›"] }, { char: "æ¤…", zhuyin: ["ã„§Ë‡"] },
  { char: "è»Š", zhuyin: ["ã„”", "ã„œ"] }, { char: "èˆ¹", zhuyin: ["ã„”", "ã„¨ã„¢ËŠ"] }
];
const questionsMid = [
  { char: "æ˜¥", zhuyin: ["ã„”", "ã„¨ã„£"] }, { char: "å¤", zhuyin: ["ã„’", "ã„§ã„šË‹"] }, { char: "ç§‹", zhuyin: ["ã„‘", "ã„§ã„¡"] }, { char: "å†¬", zhuyin: ["ã„‰", "ã„¨ã„¥"] },
  { char: "èŠ±", zhuyin: ["ã„", "ã„¨ã„š"] }, { char: "è‰", zhuyin: ["ã„˜", "ã„ Ë‡"] }, { char: "æ¨¹", zhuyin: ["ã„•", "ã„¨Ë‹"] }, { char: "è‘‰", zhuyin: ["ã„§", "ã„Ë‹"] },
  { char: "æ ¹", zhuyin: ["ã„", "ã„£"] }, { char: "æœ", zhuyin: ["ã„", "ã„¨ã„›Ë‡"] }, { char: "èœ", zhuyin: ["ã„˜", "ã„Ë‹"] }, { char: "ç±³", zhuyin: ["ã„‡", "ã„§Ë‡"] },
  { char: "é£¯", zhuyin: ["ã„ˆ", "ã„¢Ë‹"] }, { char: "æ¹¯", zhuyin: ["ã„Š", "ã„¤"] }, { char: "è›‹", zhuyin: ["ã„‰", "ã„¢Ë‹"] }, { char: "è‚‰", zhuyin: ["ã„–", "ã„¡Ë‹"] },
  { char: "ç³–", zhuyin: ["ã„Š", "ã„¤ËŠ"] }, { char: "é¹½", zhuyin: ["ã„§", "ã„¢ËŠ"] }, { char: "æ²¹", zhuyin: ["ã„§", "ã„¡ËŠ"] }, { char: "èŒ¶", zhuyin: ["ã„”", "ã„šËŠ"] },
  { char: "æ¯", zhuyin: ["ã„…", "ã„Ÿ"] }, { char: "ç¢—", zhuyin: ["ã„¨", "ã„¢Ë‡"] }, { char: "ç›¤", zhuyin: ["ã„†", "ã„¢ËŠ"] }, { char: "åˆ€", zhuyin: ["ã„‰", "ã„ "] },
  { char: "å‰", zhuyin: ["ã„”", "ã„š"] }, { char: "ç­·", zhuyin: ["ã„", "ã„¨ã„Ë‹"] }, { char: "æ¡Œ", zhuyin: ["ã„“", "ã„¨ã„›"] }, { char: "æ¤…", zhuyin: ["ã„§Ë‡"] },
  { char: "çª—", zhuyin: ["ã„”", "ã„¨ã„¤"] }, { char: "é–€", zhuyin: ["ã„‡", "ã„£ËŠ"] }, { char: "ç‰†", zhuyin: ["ã„‘", "ã„§ã„¤ËŠ"] }, { char: "åœ°", zhuyin: ["ã„‰", "ã„§Ë‹"] },
  { char: "åºŠ", zhuyin: ["ã„”", "ã„¨ã„¤ËŠ"] }, { char: "ç‡ˆ", zhuyin: ["ã„‰", "ã„¥"] }, { char: "æ›¸", zhuyin: ["ã„•", "ã„¨"] }, { char: "æœ¬", zhuyin: ["ã„…", "ã„£Ë‡"] },
  { char: "ç­†", zhuyin: ["ã„…", "ã„§Ë‡"] }, { char: "ç´™", zhuyin: ["ã„“", "ã„§Ë‡"] }, { char: "ç•«", zhuyin: ["ã„", "ã„¨ã„šË‹"] }, { char: "åœ–", zhuyin: ["ã„Š", "ã„¨ËŠ"] },
  { char: "çƒ", zhuyin: ["ã„‘", "ã„§ã„¡ËŠ"] }, { char: "è·³", zhuyin: ["ã„Š", "ã„§ã„ Ë‹"] }, { char: "è·‘", zhuyin: ["ã„†", "ã„ Ë‡"] }, { char: "æ¸¸", zhuyin: ["ã„§", "ã„¡ËŠ"] },
  { char: "å”±", zhuyin: ["ã„”", "ã„¤Ë‹"] }, { char: "æ­Œ", zhuyin: ["ã„", "ã„œ"] }, { char: "èˆ", zhuyin: ["ã„¨Ë‡"] }, { char: "æ¨‚", zhuyin: ["ã„©", "ã„Ë‹"] }
];
const questionsHigh = [
  { char: "æ„›", zhuyin: ["ã„Ë‹"] }, { char: "æ¨", zhuyin: ["ã„", "ã„£Ë‹"] }, { char: "æƒ…", zhuyin: ["ã„‘", "ã„§ã„¥ËŠ"] }, { char: "ç¾©", zhuyin: ["ã„§Ë‹"] },
  { char: "å‹‡", zhuyin: ["ã„©ã„¥Ë‡"] }, { char: "æ™º", zhuyin: ["ã„“", "ã„§Ë‹"] }, { char: "ä¿¡", zhuyin: ["ã„’", "ã„§ã„£Ë‹"] }, { char: "æœ›", zhuyin: ["ã„¨ã„¤Ë‹"] },
  { char: "å¤¢", zhuyin: ["ã„‡", "ã„¥Ë‹"] }, { char: "å…‰", zhuyin: ["ã„", "ã„¨ã„¤"] }, { char: "å½±", zhuyin: ["ã„§", "ã„¥Ë‡"] }, { char: "è²", zhuyin: ["ã„•", "ã„¥"] },
  { char: "è‰²", zhuyin: ["ã„™", "ã„œË‹"] }, { char: "å½¢", zhuyin: ["ã„’", "ã„§ã„¥ËŠ"] }, { char: "é«”", zhuyin: ["ã„Š", "ã„§Ë‡"] }, { char: "åŠ›", zhuyin: ["ã„Œ", "ã„§Ë‹"] },
  { char: "æ°£", zhuyin: ["ã„‘", "ã„§Ë‹"] }, { char: "ç¥", zhuyin: ["ã„•", "ã„£ËŠ"] }, { char: "å¿ƒ", zhuyin: ["ã„’", "ã„§ã„£"] }, { char: "æƒ…", zhuyin: ["ã„‘", "ã„§ã„¥ËŠ"] },
  { char: "æ€", zhuyin: ["ã„™", "ã„§"] }, { char: "æƒ³", zhuyin: ["ã„’", "ã„§ã„¤Ë‡"] }, { char: "çŸ¥", zhuyin: ["ã„“", "ã„§"] }, { char: "è­˜", zhuyin: ["ã„•", "ã„§Ë‹"] },
  { char: "å­¸", zhuyin: ["ã„’", "ã„©ã„ËŠ"] }, { char: "å•", zhuyin: ["ã„¨", "ã„£Ë‹"] }, { char: "ç­”", zhuyin: ["ã„‰", "ã„šËŠ"] }, { char: "èª", zhuyin: ["ã„©", "ã„©Ë‡"] },
  { char: "æ–‡", zhuyin: ["ã„¨", "ã„£ËŠ"] }, { char: "å­—", zhuyin: ["ã„—", "ã„§Ë‹"] }, { char: "æ›¸", zhuyin: ["ã„•", "ã„¨"] }, { char: "ç•«", zhuyin: ["ã„", "ã„¨ã„šË‹"] },
  { char: "è©©", zhuyin: ["ã„•", "ã„§"] }, { char: "æ­Œ", zhuyin: ["ã„", "ã„œ"] }, { char: "æ¨‚", zhuyin: ["ã„©", "ã„Ë‹"] }, { char: "èˆ", zhuyin: ["ã„¨Ë‡"] },
  { char: "é«”", zhuyin: ["ã„Š", "ã„§Ë‡"] }, { char: "è‚²", zhuyin: ["ã„©Ë‹"] }, { char: "å¥", zhuyin: ["ã„", "ã„§ã„¢Ë‹"] }, { char: "åº·", zhuyin: ["ã„", "ã„¤"] },
  { char: "é†«", zhuyin: ["ã„§", "ã„§"] }, { char: "é™¢", zhuyin: ["ã„©", "ã„¢Ë‹"] }, { char: "ç—…", zhuyin: ["ã„…", "ã„§ã„¥Ë‹"] }, { char: "è—¥", zhuyin: ["ã„§", "ã„ Ë‹"] },
  { char: "ç”Ÿ", zhuyin: ["ã„•", "ã„¥"] }, { char: "æ­»", zhuyin: ["ã„™", "ã„§Ë‡"] }
];
let questions = questionsLow;

let current = {};
let selectedZhuyin = [];
let score = 0;
let coins = parseInt(localStorage.getItem('coins')) || 0;
let timer = 180;
let interval;

const speedSlider = document.getElementById("speedSlider");
const speedValue = document.getElementById("speedValue");

speedSlider.addEventListener("input", () => {
  speedValue.innerText = speedSlider.value;
});

function shuffle(array) {
  return array.sort(() => Math.random() - 0.5);
}

function updateDisplay() {
  document.getElementById("scoreBoard").innerText = "ğŸ† å¾—åˆ†ï¼š" + score;
  document.getElementById("coinDisplay").innerText = "ğŸª™ é‡‘å¹£ï¼š" + coins;
}

function renderQuestion() {
  const q = questions[Math.floor(Math.random() * questions.length)];
  current = q;
  selectedZhuyin = [];
  document.getElementById("character").innerText = q.char;
  document.getElementById("selected").innerText = "ğŸ” é¸æ“‡æ³¨éŸ³ï¼š";
  document.getElementById("message").innerText = "";

  const options = [...q.zhuyin];
  const allZhuyin = ["ã„", "ã„ Ë‡", "ã„‹", "ã„§Ë‡", "ã„’", "ã„§ã„Ë‹", "ã„©ã„ËŠ", "ã„“", "ã„¤", "ã„§ã„¡Ë‹"];
  while (options.length < 5) {
    const fake = allZhuyin[Math.floor(Math.random() * allZhuyin.length)];
    if (!options.includes(fake)) options.push(fake);
  }

  const container = document.getElementById("options");
  container.innerHTML = "";
  shuffle(options).forEach(z => {
    const btn = document.createElement("button");
    btn.innerText = z;
    btn.onclick = () => {
      selectedZhuyin.push(z);
      document.getElementById("selected").innerText = "ğŸ” é¸æ“‡æ³¨éŸ³ï¼š" + selectedZhuyin.join(" ");
    };
    container.appendChild(btn);
  });
  document.getElementById("nextBtn").disabled = true;
}

function checkAnswer() {
  const correct = current.zhuyin.join("");
  const answer = selectedZhuyin.join("");
  if (answer === correct) {
    score++;
    coins += 10;
    document.getElementById("correctSound").play();
    // é¡¯ç¤ºæ­£ç¢ºæ³¨éŸ³ä¸¦åŠ ä¸ŠèƒŒæ™¯é¡è‰²
    showCorrectZhuyin(current.zhuyin);
    speakZhuyin(current.zhuyin, current.char);
    document.getElementById("message").innerText = "ğŸ‰ æ­£ç¢ºï¼+10 é‡‘å¹£";
    document.getElementById("nextBtn").disabled = false;
    updateDisplay();
  } else {
    document.getElementById("wrongSound").play();
    document.getElementById("message").innerText = "âŒ éŒ¯èª¤ï¼Œå†è©¦ä¸€æ¬¡ï¼";
    // éŒ¯èª¤æ™‚è‡ªå‹•é‡æ’­æ³¨éŸ³
    speakZhuyin(current.zhuyin, current.char);
  }
  localStorage.setItem('coins', coins);
// é¡¯ç¤ºæ­£ç¢ºæ³¨éŸ³ä¸¦åŠ ä¸ŠèƒŒæ™¯é¡è‰²
function showCorrectZhuyin(zhuyinArr) {
  const selectedDiv = document.getElementById("selected");
  selectedDiv.innerHTML = "é¸æ“‡æ³¨éŸ³ï¼š";
  zhuyinArr.forEach(z => {
    const span = document.createElement("span");
    span.innerText = z;
    span.style.margin = "0 5px";
    span.style.background = "#ffe066";
    span.style.borderRadius = "6px";
    span.style.padding = "2px 8px";
    span.style.color = "#222";
    selectedDiv.appendChild(span);
  });
}
}

function reset() {
  selectedZhuyin = [];
  document.getElementById("selected").innerText = "é¸æ“‡æ³¨éŸ³ï¼š";
  document.getElementById("message").innerText = "";
}

function nextQuestion() {
  renderQuestion();
}

function speakZhuyin(zhuyinArr, fullChar) {
  let delay = 0;
  const selectedDiv = document.getElementById("selected");
  selectedDiv.innerHTML = "é¸æ“‡æ³¨éŸ³ï¼š";
  zhuyinArr.forEach((z, i) => {
    const span = document.createElement("span");
    span.innerText = z;
    span.style.margin = "0 5px";
    setTimeout(() => {
      span.classList.add("bounce");
      const msg = new SpeechSynthesisUtterance(z);
      msg.lang = "zh-TW";
      msg.rate = parseFloat(speedSlider.value);
      msg.pitch = 1;
      msg.volume = parseFloat(volumeSlider.value);
      speechSynthesis.speak(msg);
    }, delay);
    selectedDiv.appendChild(span);
    delay += 600;
  });
  setTimeout(() => {
    const msg = new SpeechSynthesisUtterance(fullChar);
    msg.lang = "zh-TW";
    msg.rate = parseFloat(speedSlider.value);
    speechSynthesis.speak(msg);
  }, delay + 400);
}

function startGame() {
  // æ ¹æ“šå¹´ç´šé¸æ“‡é¡Œåº«
  const level = document.getElementById("levelSelect").value;
  if (level === "low") {
    questions = questionsLow;
  } else if (level === "mid") {
    questions = questionsMid;
  } else {
    questions = questionsHigh;
  }
  score = 0;
  timer = 180;
  document.getElementById("startBtn").style.display = "none";
  document.getElementById("character").style.display = "block";
  renderQuestion();
  updateDisplay();
  document.getElementById("timer").innerText = "â³ å€’æ•¸ï¼š180ç§’";

  interval = setInterval(() => {
    timer--;
    document.getElementById("timer").innerText = `â³ å€’æ•¸ï¼š${timer}ç§’`;
    if (timer <= 0) {
      clearInterval(interval);
      document.getElementById("message").innerText = `â° æ™‚é–“åˆ°ï¼ç¸½å¾—åˆ†ï¼š${score} åˆ†ï¼ŒåŠ ç¸½é‡‘å¹£ï¼š${coins}`;
      document.getElementById("character").style.display = "none";
      document.getElementById("options").innerHTML = "";
      document.getElementById("selected").innerText = "";
      document.getElementById("startBtn").style.display = "inline-block";
    }
  }, 1000);
}

// ç›£è½å¹´ç´šé¸æ“‡è®Šæ›´
document.getElementById("levelSelect").addEventListener("change", function() {
  const level = this.value;
  if (level === "low") {
    questions = questionsLow;
  } else if (level === "mid") {
    questions = questionsMid;
  } else if (level === "high") {
    questions = questionsHigh;
  }
  reset();
});

const volumeSlider = document.getElementById("volumeSlider");
const volumeValue = document.getElementById("volumeValue");

volumeSlider.addEventListener("input", () => {
  volumeValue.innerText = parseFloat(volumeSlider.value).toFixed(2);
});
</script>
</body>
</html>
